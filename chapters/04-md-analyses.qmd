---
title: "MD Simülasyon Analizleri"
---

## Bu Bölümde Neler Öğreneceğiz?

Bu bölümde MD simülasyonlarının analizleri için kullanılan bazı standart teknikler anlatılacaktır. Bu analiz teknikleri yapısal ve enerji analizleri olarak ikiye ayrılabilir. Ele alacağımız yapısal analiz teknikleri şunlardır: RMSD, RMSF, Rg,SASA, ikincil yapı, PCA. 


## Yapısal Analizler
Moleküler dinamik (MD) simülasyonları, atomik düzeyde bir sistemin zaman içindeki davranışını incelememizi sağlar.  
Bu tür simülasyonlarda elde edilen sonuçların anlamlı şekilde yorumlanabilmesi için çeşitli **yapısal analiz yöntemleri** kullanılır. Yapısal analizleri gerçekleştirebilmeniz için elimizde bir topoloji dosyası (genellikle gro, pdb veya tpr formatında) ve bir yörünge dosyası (xtc veya trr formatında) bulunması gerekir. 

### RMSD (Root Mean Square Deviation)

**RMSD (Root Mean Square Deviation)**, bir molekülün belirli bir referans yapısına göre ortalama konum değişimini nicel olarak ölçen bir metriktir.  
Basitçe ifade etmek gerekirse, RMSD zaman içinde yapının **ne kadar değiştiğini** gösterir.

Matematiksel olarak RMSD şöyle tanımlanır:

$$
RMSD = \sqrt{ \frac{1}{N} \sum_{i=1}^{N} (\mathbf{r}_i(t) - \mathbf{r}_i^{ref})^2 }
$$


Burada:

- $N$: Karşılaştırılan atom sayısıdır.  
- $\mathbf{r}_i(t)$: Zaman $t$’deki *i*. atomun koordinatıdır.  
- $\mathbf{r}_i^{\text{ref}}$: Referans yapıdaki *i*. atomun koordinatıdır.


#### RMSD'nin Anlamı

RMSD değeri bize sistemin **yapısal kararlılığı** hakkında bilgi verir:

| RMSD Değeri | Yorum |
|--------------|--------|
| 0 – 1 Å | Yapı referansa çok benzer; yüksek kararlılık |
| 1 – 3 Å | Küçük yapısal değişiklikler; olası uyum veya gevşeme |
| > 3 Å | Belirgin yapısal değişim veya konformasyonel geçiş |

> 💡 RMSD’nin tek başına bir ölçüt olmadığı unutulmamalıdır.  
> Yüksek RMSD değeri her zaman sistemin dengesiz olduğu anlamına gelmez; yapının farklı ama kararlı bir konformasyona geçmesi de mümkündür.

---

#### Referans Yapı Seçimi

RMSD analizinde kullanılacak **referans yapı** son derece önemlidir.  
Genellikle aşağıdaki seçeneklerden biri tercih edilir:

1. **Başlangıç yapısı** (örneğin enerji minimizasyon sonrası yapı)  
2. **Zaman ortalaması alınmış yapı**  
3. **Kristal yapı veya deneysel referans**

Her durumda, RMSD hesaplanmadan önce **hizalama (alignment)** yapılmalıdır.  
Bu hizalama genellikle **Cα (alfa karbon)** veya **backbone** atomları üzerinden gerçekleştirilir.

Gromacs ile RMSD hesaplamak için aşağıdaki komutu Terminal'de yazmak yeterli olacaktır:

`echo 3 3 | gmx rms -s pdb_filename -f traj_filename -o rmsd.xvg -tu ns` 

### RMSF (Root Mean Squared Fluctuations):

**RMSF (Root Mean Square Fluctuation)**, moleküler dinamik (MD) simülasyonlarında her bir atomun veya rezidünün zaman içindeki ortalama konum dalgalanmasını ölçen bir metriktir. Bu analiz, yapının hangi bölgelerinin **esnek**, hangi bölgelerinin **daha rijit** olduğunu anlamak için kullanılır.

---

#### RMSF Tanımı

Her bir atom veya rezidü için RMSF değeri şu şekilde hesaplanır:

$$
\text{RMSF}_i = \sqrt{ \left\langle \left( \mathbf{r}_i(t) - \langle \mathbf{r}_i \rangle \right)^2 \right\rangle_t }
$$

Burada:  
- $\mathbf{r}_i(t)$: Zaman $t$’deki *i*. atomun koordinatıdır.  
- $\langle \mathbf{r}_i \rangle$: Tüm simülasyon süresince *i*. atomun ortalama konumudur.  
- $\langle \cdots \rangle_t$: Zaman ortalamasını ifade eder.

---

#### RMSF’nin Yorumu

- **Düşük RMSF değerleri (0–1 Å)**: Bölge katıdır, genellikle protein çekirdeği veya ikincil yapı elementleri (örneğin α-heliks, β-tabaka).  
- **Yüksek RMSF değerleri (2–5 Å ve üzeri)**: Bölge esnektir, genellikle loop, uç kısımlar veya bağlanma bölgeleri.

---

Gromacs ile RMSF hesaplamak için aşağıdaki komutu Terminal'de yazmak yeterli olacaktır:

`echo 3 3 | gmx rmsf -s pdb_filename -f traj_filename -res -oq rmsf.pdb`

---

### Radius of Gyration (Rg) Analizi
**Radius of Gyration (Rg)**, bir molekülün kütle merkezine göre atomlarının ne kadar dağılmış olduğunu ölçen bir metriktir. Proteinlerde Rg genellikle **kompaktlık**, **katlanma durumu** ve **kararlılık** hakkında bilgi verir. Radius of gyration şu şekilde tanımlanır:

$$
R_g = \sqrt{ \frac{ \sum_{i=1}^{N} m_i \left| \mathbf{r}_i - \mathbf{r}_{\text{km}} \right|^2 }{ \sum_{i=1}^{N} m_i } }
$$

Burada:  

- $m_i$: *i*. atomun kütlesi,  
- $\mathbf{r}_i$: *i*. atomun koordinatı,  
- $\mathbf{r}_{\text{km}}$: sistemin kütle merkezidir,  
- $N$: toplam atom sayısıdır.


| Rg Değeri | Yorum |
|------------|--------|
| Düşük Rg (örneğin 15 Å) | Protein kompakt, katlanmış durumda |
| Yüksek Rg (örneğin 25 Å) | Protein genişlemiş veya kısmen açılmış durumda |

> 💡 Zaman içinde Rg’nin sabit kalması sistemin **katlanma kararlılığını**,  
> düzenli artması ise **açılmayı (unfolding)** gösterebilir.

---

Gromacs ile Rg hesaplamak için aşağıdaki komutu Terminal'de yazmak yeterli olacaktır:

`echo 3 3| gmx gyrate -s pdb_filename -f traj_filename -o gyrate.xvg`


### SASA (Solvent Accessible Surface Area):

**SASA (Solvent Accessible Surface Area)**, bir molekülün çözücü (genellikle su) tarafından erişilebilir yüzey alanını ifade eder.  
Bu kavram, proteinlerin **hidrofobik ve hidrofilik yüzey özelliklerini**, **katlanma davranışlarını** ve **ligand bağlanma bölgelerinin** analizini anlamada önemli bir ölçüttür.

Bir molekülün SASA’sı, hayali bir **çözücü küresi** (örneğin su molekülü için yarıçapı yaklaşık 1.4 Å) kullanılarak hesaplanır. Bu küre, molekülün atomları etrafında “yuvarlanır” ve çözücünün temas edebileceği yüzey alanı ölçülür.

**SASA değeri**, genellikle şu iki katkının toplamıdır:

$$
SASA_{\text{total}} = SASA_{\text{polar}} + SASA_{\text{apolar}}
$$

- $SASA_{\text{polar}}$: Hidrofilik (kutupsal) atomların oluşturduğu yüzey alanı,  
- $SASA_{\text{apolar}}$: Hidrofobik (apolar) atomların oluşturduğu yüzey alanı.

---

#### SASA Hesaplama Yöntemi

SASA tipik olarak **Lee–Richards algoritması** (1971) veya **Shrake–Rupley yöntemi** (1973) kullanılarak hesaplanır.  
Bu yöntemlerde atomlar **Van der Waals yarıçapına** sahip küreler olarak temsil edilir.  
Bir çözücü küresi bu yüzeyde gezdirilerek toplam erişilebilir alan sayısal olarak bulunur.

> 💡 **Basitleştirilmiş fikir:**  
> Su molekülü, proteinin etrafında “kayarken” hangi atomlara temas edebiliyorsa, o atomlar SASA’ya katkı yapar.

---

#### SASA ve Yapısal Özellikler

SASA değeri proteinlerin **katlanma durumu** ve **kararlılığı** hakkında güçlü ipuçları verir:

| Gözlenen Durum | SASA Davranışı | Yorum |
|----------------|----------------|--------|
| Katlanmış protein | SASA düşük | Hidrofobik bölgeler iç kısımda, çözücüden korunmuş |
| Açılmış protein | SASA yüksek | Hidrofobik bölgeler açığa çıkmış |
| Ligand bağlanması | SASA azalır | Bağlanma bölgesinde çözücü erişimi kısıtlanır |


Gromacs ile SASA hesaplamak için aşağıdaki komutu Terminal'de yazmak yeterli olacaktır:
`echo 1|gmx sasa -s pdb_filename -f traj_filename -o sasa.xvg -tu ns`


### İkincil Yapı

Proteinlerin **ikincil yapıları** (örneğin $\alpha$-heliks ve $\beta$-tabaka bölgeleri), üç boyutlu katlanmalarının temelini oluşturur. Moleküler dinamik (MD) simülasyonları, bu yapıların zaman içindeki **kararlılığını** ve **dönüşüm süreçlerini** incelemek için güçlü bir araçtır. İkincil yapı analizleri, simülasyon süresince protein zincirinin **hangi bölgelerinde heliks, tabaka veya düzensiz yapı** (coil, turn vb.) bulunduğunu izlemeye dayanır.

---

### İkincil Yapıların Tanımlanması

MD simülasyonlarında ikincil yapı elemanları genellikle **DSSP (Define Secondary Structure of Proteins)** algoritmasıyla belirlenir. DSSP, hidrojen bağlarını ve geometriyi temel alarak her bir amino asidi sınıflandırır:

| Sembol | Yapı Türü | Açıklama |
|:-------:|------------|-----------|
| H | $\alpha$-Heliks | Düzenli helikal yapı |
| G | 3₁₀-Heliks | Sıkı helikal yapı |
| E | $\beta$-Tabaka | Uzamış yapı |
| T | Turn | Zincir yön değişimi |
| C | Coil | Düzensiz bölge |

---

### Zaman İçinde İkincil Yapı Değişimi

Simülasyon boyunca ikincil yapı değişimleri genellikle bir **zaman–residue** ısı haritası (heatmap) şeklinde gösterilir.  
Bu tür analizler, **kararlı bölgelerin** (örneğin sürekli helikal kalan segmentler) ve **esnek bölgelerin** (heliks–coil dönüşümü yapan kısımlar) ayırt edilmesini sağlar.

> 💡 **Yorum:**  
> Eğer bir $\alpha$-heliks bölgesi zamanla coil yapıya dönüşüyorsa, bu durum genellikle lokal kararlılığın azalması veya çevresel etkilerin (örneğin sıcaklık, ligand bağlanması) artmasıyla ilişkilidir.



### Nicel Analiz Yöntemleri

Bazı metrikler ikincil yapı değişimini sayısal olarak özetler:

- **Heliks oranı ($f_H$)**: Zaman ortalaması olarak heliks karakterine sahip rezidülerin yüzdesi.  
- **Tabaka oranı ($f_E$)**: $\beta$-yapı içeren rezidülerin oranı.  
- **DSSP zaman profili**: Her bir rezidülerin için zaman içinde yapısal durumun izlenmesi.

Gromacs ile ikincil yapı değişimlerini hesaplamak için aşağıdaki komutu Terminal'de yazmak yeterli olacaktır:

`gmx do_dssp -s pdb_filename -f traj_filename -o dssp.xpm -sc residue_count.xvg`

`do_dssp` programı arka planda dssp yazılımını kullanır (Burada atıf yaz.). Eğer Ubuntu işletim sistemini kullanıyorsanız bu programı aşağıdaki komut ile önceden kurmak gerekir:

`sudo apt install dssp`

## Enerji Analizleri

## Bölüm Özeti


